# 요구사항

## 상품 목록 조회

### 스토리

* 사용자는 검색어로 상품을 조회할 수 있다.
* 특정 브랜드를 지정하여 검색할 수 있다.
* 최신/인기/가격 순으로 조회할 수 있다.
* 비회원도 조회할 수 있다.

### 흐름

#### 성공

1. 브랜드를 지정하면, 그 브랜드의 상품만 조회
2. 최신순 정렬은 `상품 등록일시`를 기준
3. 인기순 정렬은 `(최근 4일 간 판매 수) + (좋아요 수) + (조회 수)`에 가중치
4. 가격순 정렬은 `기준 가격`을 기준

#### 실패

1. 검색 조건에 맞는 상품이 없으면, 빈 목록을 반환

## 상품 상세 조회

### 스토리

* 사용자는 상품의 상세 정보를 조회할 수 있다.
* 비회원도 조회할 수 있다.

### 흐름

#### 성공

1. 상품 옵션, 재고, 좋아요 여부/개수 조회
2. 회원이면 조회 상품 목록에 저장, 이미 조회했다면 일시만 갱신

#### 실패

1. 존재하지 않는 상품이면, 404 Not Found 오류 발생
2. 조회 목록 저장에 실패해도, 오류를 발생하지 않음

## 브랜드 상세 조회

### 스토리

* 사용자는 브랜드의 상세 정보를 조회할 수 있다.
* 브랜드에 속한 상품 목록을 조회할 수 있다.
* 비회원도 조회할 수 있다.

### 흐름

#### 성공

1. 브랜드의 상세 정보 조회
2. 브랜드의 상품 5개를 최근순으로 조회

#### 실패

1. 존재하지 않는 브랜드면, 404 Not Found 오류 발생
2. 상품이 존재하지 않으면, 빈 목록을 반환

## 상품 좋아요 등록

### 스토리

* 회원만 상품에 대해 좋아요를 표시할 수 있다.
* 판매중이 아닌 상품도 가능하다.

### 흐름

#### 성공

1. 상품을 조회
2. 좋아요를 저장, 이미 좋아요 표시됐다면 일시만 갱신

#### 실패

1. 존재하지 않는 사용자면, 401 Unauthorized 발생
2. 존재하지 않는 상품이면, 404 Not Found 오류 발생

## 상품 좋아요 취소

### 스토리

* 회원만 상품에 대해 좋아요를 취소할 수 있다.
* 판매중이 아닌 상품도 가능하다.

### 흐름

#### 성공

1. 상품을 조회
2. 좋아요를 삭제, 좋아요 표시가 없는지를 따지지 않음

#### 실패

1. 존재하지 않는 사용자면, 401 Unauthorized 오류 발생
2. 존재하지 않는 상품이면, 404 Not Found 오류 발생

## 주문 생성

### 스토리

* 회원만 상품을 주문할 수 있다.
* 서로 다른 상품과 상품 옵션을 다수 선택할 수 있다.
* 상품을 100개까지 담을 수 있다.
* 10분 내로 결제되지 않은 주문은 자동 취소된다.

### 흐름

#### 성공

1. 회원 정보를 조회
2. 상품을 조회
3. 재고를 조회
4. 보유 포인트를 조회
5. 지불 금액을 계산
6. 주문 정보를 저장

#### 실패

1. 상품 수가 100개를 초과하면, 400 Bad Request 오류 발생
2. 존재하지 않는 사용자면, 401 Unauthorized 오류 발생
3. 존재하지 않는 상품이면, 404 Not Found 오류 발생
4. 판매중이 아닌 상품이면, 422 Unprocessable Entity 오류 발생
5. 품절된 상품이면, 422 Unprocessable Entity 오류 발생
6. 포인트가 부족하면, 400 Bad Request 오류 발생

## 결제 요청

### 스토리

* 회원만 결제할 수 있다.
* 결제를 성공하면 주문이 완료된다.
* 회원의 포인트가 액수만큼 차감된다.

### 흐름

#### 성공

1. 주문 정보를 조회
2. 포인트를 차감
3. 재고를 차감
4. 결제 정보를 저장
5. 주문 상태를 완료로 변경

#### 실패

1. 존재하지 않는 주문이면, 404 Not Found 오류 발생
2. 만료된 주문이면, 422 Unprocessable Entity 오류 발생
3. 포인트가 부족하면, 400 Bad Request 오류 발생
4. 재고 차감에 실패하면, 400 Bad Request 오류 발생

---

# 유비쿼터스 언어

## 사용자

* 사용자 (User): 시스템을 사용하는 모든 사람
* 회원 (Logged-in User): 인증된 사용자
* 비회원 (Anonymous User): 인증하지 않은 사용자

## 상품

* 상품 (Product): 사용자에게 제공되는 판매 대상
* 상품 옵션 (Product Option): 상품의 세부 선택 항목 (e.g. 색상, 용량, 사이즈)
* 재고 (Stock): 상품 옵션별 남아있는 수량
* 기준 가격 (Base Price): 상품 옵션 중 가장 낮은 가격
* 상품 등록일시 (Product Created At): 상품이 시스템에 등록된 시점
* 판매중 (On Sale): 상품의 구매 가능한 상태 
* 품절 (Sold Out): 재고가 0인 상품
* 좋아요 (Like): 회원이 상품에 대해 긍정 반응을 남기는 행위
* 좋아요 수 (Like Count): 상품의 좋아요 횟수
* 조회 수 (View Count): 상품이 조회된 총 횟수
* 인기 지수 (Popularity Score): (최근 4일 판매 수 + 좋아요 수 + 조회 수)에 가중치를 적용한 값

## 브랜드

* 브랜드 (Brand): 상품이 소속된 제조사 또는 상표
* 브랜드 상세 정보 (Brand Detail): 브랜드 설명, 로고 등의 정보

## 포인트

* 보유 포인트 (Balance): 회원이 현재 사용할 수 있는 포인트
* 포인트 소비 (Point Spending): 결제 시 포인트를 사용하여 줄이는 행위

## 주문

* 주문 (Order): 사용자가 상품을 구매하겠다고 요청한 기록
* 주문 생성 (Order Creation): 사용자가 장바구니처럼 주문을 등록하는 행위
* 지불 금액 (Total Price): 주문을 완료하기 위한 회원의 결제 필요 금액
* 주문 상태 (Order Status): 주문의 현재 상태 (e.g. 생성됨, 완료됨, 취소됨)
* 만료된 주문 (Expired Order): 생성 후 10분 내에 결제가 되지 않아 무효가 된 주문

## 결제

* 결제 요청 (Payment Request): 주문을 완료하기 위해 실제로 돈을 지불하는 요청
* 결제 상태 (Payment Status): 결제의 현재 상태 (e.g. 완료됨, 취소됨)
* 결제 수단 (Payment Method): 돈을 지불하기 위한 수단 (e.g. 포인트, 카드, 가상계좌)
